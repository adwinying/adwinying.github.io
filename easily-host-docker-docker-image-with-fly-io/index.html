<!DOCTYPE html>
<html lang="en">
<head>
  <title>Easily Host a Docker Image with fly.io - iAdwin</title>

<link rel="canonical" href="https://iadw.in/easily-host-docker-docker-image-with-fly-io/">

<meta name="description" content="It's free and easy, what more would you want?">

<meta name="robots" content="index, follow">

<meta property="og:title" content="Easily Host a Docker Image with fly.io">
<meta property="og:type" content="article">
<meta property="og:image" content="https://iadw.in/img/social.jpg">
<meta property="og:url" content="https://iadw.in/easily-host-docker-docker-image-with-fly-io/">


<meta property="og:description" content="It's free and easy, what more would you want?">






<meta property="og:image:url" content="https://iadw.in/img/social.jpg">



<meta property="og:image:height">
<meta property="og:image:alt" content="Easily Host a Docker Image with fly.io">


<meta name="twitter:card" content="summary_large_image">




<meta content="width=device-width, initial-scale=1.0" name="viewport"><meta content="Adwin Ying" name="author">


  <meta charSet="UTF-8"/><meta name="theme-color" content="#ffffff"/><link rel="icon" href="/favicon.svg"/><link rel="mask-icon" href="/mask-icon.svg" color="#000000"/><link rel="apple-touch-icon" href="/apple-touch-icon.png"/><link rel="manifest" href="/manifest.json"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,500;1,500&amp;family=Open+Sans:ital,wght@0,300;0,400;0,700;1,400;1,700&amp;display=swap"/><script async="" defer="" data-website-id="5defccd5-b1c2-4556-8635-cfd36e168899" src="https://u.iadw.in/bundle.js"></script>

  
<link rel="stylesheet" href="/assets/404-_slug_-blog-index-tag-_tag_.e5d1e939.css" /></head>

<body class="flex flex-col bg-gray-50 min-h-screen ">
  <header class="container mx-auto flex items-center space-x-3 px-5 py-7"><a href="/" class="font-title text-3xl tracking-wider" aria-label="iAdwin">iA</a><span class="h-9 border-r-[2.5px] border-black"></span><a href="/blog" class="font-sans text-3xl font-normal text-gray-900">Blog</a><a href="/blog/rss.xml" target="_parent"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="mt-1 h-5"><path fill="currentColor" d="M128.081 415.959c0 35.369-28.672 64.041-64.041 64.041S0 451.328 0 415.959s28.672-64.041 64.041-64.041 64.04 28.673 64.04 64.041zm175.66 47.25c-8.354-154.6-132.185-278.587-286.95-286.95C7.656 175.765 0 183.105 0 192.253v48.069c0 8.415 6.49 15.472 14.887 16.018 111.832 7.284 201.473 96.702 208.772 208.772.547 8.397 7.604 14.887 16.018 14.887h48.069c9.149.001 16.489-7.655 15.995-16.79zm144.249.288C439.596 229.677 251.465 40.445 16.503 32.01 7.473 31.686 0 38.981 0 48.016v48.068c0 8.625 6.835 15.645 15.453 15.999 191.179 7.839 344.627 161.316 352.465 352.465.353 8.618 7.373 15.453 15.999 15.453h48.068c9.034-.001 16.329-7.474 16.005-16.504z"></path></svg></a></header><article class="mx-auto w-full max-w-blog p-5 pb-9"><div class="mb-8 font-sans"><h1 class="mb-1 text-5xl font-bold text-gray-900">Easily Host a Docker Image with fly.io</h1><span class="inline-block text-sm text-gray-600">12 Sept 2022<!-- --> | <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="mr-1 inline-block h-2.5"><path fill="currentColor" d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"></path></svg><a href="/tag/servers/" class="text-sm text-gray-600 underline-offset-1 hover:underline ">servers</a>, <a href="/tag/homelab/" class="text-sm text-gray-600 underline-offset-1 hover:underline ">homelab</a>, <a href="/tag/docker/" class="text-sm text-gray-600 underline-offset-1 hover:underline ">docker</a>, <a href="/tag/fly-io/" class="text-sm text-gray-600 underline-offset-1 hover:underline ">fly-io</a></span></div><div class="prose prose-lg max-w-none font-serif
          prose-headings:font-sans prose-figcaption:text-center
          prose-figcaption:font-sans prose-figcaption:text-sm"><p>With <a href="https://help.heroku.com/RSBRUH58/removal-of-heroku-free-product-plans-faq">Heroku no longer a viable option for free hosting</a> of web services and databases, I find that <a href="https://fly.io">fly.io</a> is a great alternative.</p>
<p>Fly.io offers a generous free tier by offering up to 3 VMs (1vCPU, 256MB RAM) and 3GB of persistent storage (which can be used for databases) for each organization. You can create as many organizations as you want, so you can create more organizations when you need more resources. On top of that, fly.io does not suspend servers when not in use, which in some ways is better than Heroku. Granted, fly.io requires a credit card, but it's unlike you'll get charged unless you messed around with autoscaling.</p>
<h2 id="hosting-a-standalone-docker-image">Hosting a standalone docker image</h2>
<p>I found out recently that you can easily host a docker image on fly.io. This is great for hosting your own instance of any popular web service, ranging from a <a href="https://ghost.org/">Ghost blog</a> to <a href="https://github.com/louislam/uptime-kuma">Uptime Kuma</a>. You can also easily try out any pre-build docker images and tear down without much effort.</p>
<h2 id="instructions">Instructions</h2>
<h3 id="step-1-install-flyctl">Step 1: Install <code>flyctl</code></h3>
<p>Instructions are available in the <a href="https://fly.io/docs/flyctl/installing/">fly.io docs</a>. If you're on Arch Linux, there's a <a href="https://aur.archlinux.org/packages/flyctl-bin">AUR package</a>.</p>
<h3 id="step-2-generate-a-flytoml-file">Step 2: Generate a <code>fly.toml</code> file</h3>
<p>A <code>fly.toml</code> contains all the configuration of your fly.io app. To generate one you can use the following command:</p>
<pre is:raw="" class="astro-code" style="background-color: #2e3440ff; overflow-x: auto;"><code><span class="line"><span style="color: #D8DEE9FF">$ fly launch --image=</span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">image_name:version_tag</span><span style="color: #ECEFF4">]</span></span></code></pre>
<p>The command will prompt you for a unique application name, as well as the region and organization that you want to use for the VM. If you need a PostgreSQL database, this command enables you to create one as well.</p>
<h3 id="step-3-deploy">Step 3: Deploy</h3>
<p>When you're satisfied with your config just deploy the application with the following command:</p>
<pre is:raw="" class="astro-code" style="background-color: #2e3440ff; overflow-x: auto;"><code><span class="line"><span style="color: #D8DEE9FF">$ fly deploy</span></span></code></pre>
<p>And you'll see your application live at <code>[application_name].fly.dev</code>.</p>
<h2 id="bonus">Bonus</h2>
<h3 id="need-persistent-storage">Need persistent storage?</h3>
<p>As with running any docker image, changes made to the image will not be preserve and you'll need to mount a volume in order to keep the data even after a restart or a redeployment. To create a volume:</p>
<pre is:raw="" class="astro-code" style="background-color: #2e3440ff; overflow-x: auto;"><code><span class="line"><span style="color: #D8DEE9FF">$ fly volumes create </span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">volume_name</span><span style="color: #ECEFF4">]</span><span style="color: #D8DEE9FF"> --size=</span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">integer_size_in_GB</span><span style="color: #ECEFF4">]</span></span></code></pre>
<p>After creating you'll need to add the following lines to your <code>fly.toml</code> file to mount the volume:</p>
<pre is:raw="" class="astro-code" style="background-color: #2e3440ff; overflow-x: auto;"><code><span class="line"><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">mounts</span><span style="color: #ECEFF4">]</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #D8DEE9">source</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">[volume_name]</span><span style="color: #ECEFF4">"</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #D8DEE9">destination</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">"</span><span style="color: #A3BE8C">/path/to/volume/mount/dir</span><span style="color: #ECEFF4">"</span></span></code></pre>
<p>Run <code>fly deploy</code> to apply the changes.</p>
<h3 id="need-https">Need HTTPS?</h3>
<p>Fly.io comes with SSL certificates generated by Let's Encrypt by default. If you want to use a custom domain you'll need to provide the custom domains that you want to use:</p>
<pre is:raw="" class="astro-code" style="background-color: #2e3440ff; overflow-x: auto;"><code><span class="line"><span style="color: #D8DEE9FF">$ fly certs create </span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">custom_domain</span><span style="color: #ECEFF4">]</span></span></code></pre>
<p>You'll need to update your domain's DNS settings (CNAME for a subdomain, A record for an apex domain). The <a href="https://fly.io/docs/app-guides/custom-domains-with-fly/">fly.io docs</a> provides a detailed explanation on how to configure your custom domain.</p>
<p>If you're using Cloudflare's proxy DNS, you might run into problems verifying your domain ownership. You can try the alternative verification method that is listed on fly.io's web portal instead. The alternative verification involves adding a custom CNAME DNS entry to your domain.</p>
<figure><img src="/uploads/fly-io-domain-verification.png" alt="Verifying custom domain ownership on fly.io"><figcaption>Under Organization > App > Certificates, select the domain you want to verify and follow the instructions provided</figcaption></figure><hr/></div><div class="flex flex-col space-y-3 sm:flex-row sm:items-center sm:space-x-5 sm:space-y-0 mt-14 mb-9 font-sans text-base"><div class="w-28 sm:w-32"><img src="/img/avatar.png" srcSet="/assets/avatar@112w.377da505.png 112w, /assets/avatar@128w.9acea303.png 128w" alt="Adwin Ying&#x27;s avatar"/></div><div class="flex flex-1 flex-col space-y-1"><span class="text-2xl font-bold">Adwin Ying</span><p class="text-gray-800">Self-taught full-stack web dev based in Tokyo.<!-- --> <br class="hidden sm:block"/>Occasionally wrecks servers through <a class="text-sky-500 hover:text-sky-700 " href="https://www.reddit.com/r/selfhosted/">self-hosting</a> and <a class="text-sky-500 hover:text-sky-700 " href="https://www.reddit.com/r/homelab/">homelab-ing</a>.</p><div class="flex"><a class="text-sky-500 hover:text-sky-700 flex space-x-1" href="/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-4"><path fill="currentColor" d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg><span>https://iAdw.in</span></a></div></div></div><a class="text-sky-500 hover:text-sky-700 font-sans !text-gray-900 underline underline-offset-2" href="/blog">← Back to all posts</a></article><footer class="bg-black py-3 text-center text-gray-50">iAdwin © <!-- -->2023<!-- --> Adwin Ying.</footer>
</body></html>